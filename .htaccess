RewriteEngine On

# === SECURITY & PERFORMANCE ===

# Prevent access to .htaccess file
<Files .htaccess>
Order allow,deny
Deny from all
</Files>

# Gzip compression
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Cache control
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType text/html "access plus 1 week"
  ExpiresDefault "access plus 2 days"
</IfModule>

# === REDIRECTS ===

# Redirect HTTP → HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirect instalarewindowsbrasov.com → crank-it.ro
RewriteCond %{HTTP_HOST} ^(www\.)?instalarewindowsbrasov\.com$ [NC]
RewriteRule ^(.*)$ https://crank-it.ro/$1 [L,R=301]

# Force non-www for crank-it.ro
RewriteCond %{HTTP_HOST} ^www\.crank-it\.ro$ [NC]
RewriteRule ^(.*)$ https://crank-it.ro/$1 [L,R=301]

# Redirect /index or /index.html to root
RewriteRule ^index(\.html)?$ / [R=301,L]

# Old URLs to new URLs (custom redirects)
Redirect 301 /service_periph.html /instalare-periferice-imprimanta-brasov.html
Redirect 301 /service_cons.html /consultanta-it-brasov.html
Redirect 301 /service_praf.html /curatare-calculator-laptop-de-praf-brasov.html
Redirect 301 /service_vir.html /devirusare-calculator-laptop-brasov.html
Redirect 301 /service_lnx.html /instalare-linux-brasov.html
Redirect 301 /service_gmg.html /asamblare-calculator-pc-unitate-desktop-gaming-brasov.html
Redirect 301 /articol-blog-crank-it-2/ /blog-crank-it/

# === ERRORS ===
ErrorDocument 404 /404.html
ErrorDocument 500 /500.html

# === CANONICAL HEADER ===
<IfModule mod_headers.c>
  Header always set Link "<https://crank-it.ro%{REQUEST_URI}>; rel=\"canonical\"" env=REDIRECT_STATUS
</IfModule>